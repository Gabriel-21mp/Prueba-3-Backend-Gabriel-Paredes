<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Reporte de Pedidos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>Reporte de Pedidos por Estado</h1>

<form method="get">
    <label>Filtrar por estado:</label>
    <select name="estado">
        <option value="">Todos</option>
        {% for e in estados %}
            <option value="{{ e }}" {% if e == estado_seleccionado %}selected{% endif %}>
                {{ e }}
            </option>
        {% endfor %}
    </select>
    <button type="submit">Filtrar</button>
</form>

<hr>

<table border="1" cellpadding="6">
    <tr>
        <th>Estado</th>
        <th>Total</th>
    </tr>
    {% for p in pedidos_por_estado %}
    <tr>
        <td>{{ p.estado_pedido }}</td>
        <td>{{ p.total }}</td>
    </tr>
    {% endfor %}
</table>

<hr>

<canvas id="graficoPedidos" width="400" height="200"></canvas>

<script>
const labels = [
    {% for p in pedidos_por_estado %}
        "{{ p.estado_pedido }}",
    {% endfor %}
];

const data = [
    {% for p in pedidos_por_estado %}
        {{ p.total }},
    {% endfor %}
];

new Chart(document.getElementById("graficoPedidos"), {
    type: "bar",
    data: {
        labels: labels,
        datasets: [{
            label: "Cantidad de pedidos",
            data: data,
            backgroundColor: "rgba(54, 162, 235, 0.7)"
        }]
    }
});
</script>

<br>
<a href="/admin/">‚Üê Volver al admin</a>

</body>
</html>
